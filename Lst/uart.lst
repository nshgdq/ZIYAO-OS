C51 COMPILER V9.00   UART                                                                  06/18/2015 18:24:36 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\Object\uart.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE user\uart\uart.c LARGE BROWSE INCDIR(.\user\LCD;.\user\W25Qxx;.\user;.\user
                    -\TOUCH;.\user\flash;.\user\ds1302;.\user\timer;.\user\GUI;.\user\ds18b20;.\user\uart) DEBUG OBJECTEXTEND PRINT(.\Lst\uar
                    -t.lst) OBJECT(.\Object\uart.obj)

line level    source

   1          #include"uart.h"
   2          #define S2RI 0x01       //串口2接收中断请求标志位
   3          #define S2TI 0x02       //串口2发送中断请求标志位
   4          unsigned char temp[20];
   5          bit flag=0;
   6          unsigned char *p=temp;
   7          /****************串行口初始化函数****************/
   8          void InitUART(bit bite)//9600/115200@32MHZ
   9          {
  10   1              AUXR &= 0xF7;           //波特率不倍速
  11   1              S2CON = 0x50;           //8位数据,可变波特率
  12   1              AUXR |= 0x04;           //独立波特率发生器时钟为Fosc,即1T
  13   1              if(!bite)       BRT = 0x98;             //9600
  14   1              if(bite) BRT = 0xf7;            //115200
  15   1              AUXR |= 0x10;           //启动独立波特率发生器
  16   1              EA =1;  //开总中断
  17   1        IE2 =0x01;    //开串口2中断  ES2=1
  18   1      }
  19          void UART_SendOneByte(unsigned char c)
  20          {
  21   1          S2BUF = c;
  22   1          while(!(S2CON&S2TI));  //若S2TI=0，在此等待
  23   1          S2CON&=~S2TI;         //S2TI=0
  24   1      }
  25          /************串行口2中断处理函数*************/
  26          void UART_Interrupt(void) interrupt 8
  27          {
  28   1              if(flag==0) p=temp;
  29   1              if(S2CON&S2RI)
  30   1              {
  31   2                      flag=1;
  32   2                      S2CON&=~S2RI;
  33   2                      *p=S2BUF;
  34   2      //              UART_SendOneByte(*p);
  35   2                      p++;
  36   2                      *p=0;
  37   2              } 
  38   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    149    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     23    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
